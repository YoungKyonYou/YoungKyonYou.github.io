I"‘h<p><span style="color:orange; font-weight:bold"><em>í•´ë‹¹ ë‚´ìš©ì€ ì±… â€˜ì½”ë“œë¡œ ë°°ìš°ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ ì›¹ í”„ë¡œì íŠ¸â€™ì— ë‚˜ì˜¤ëŠ” ë‚´ìš©ì´ë©° ì´ëŠ” ê°œì¸ì ìœ¼ë¡œ ê³µë¶€í•˜ê¸° ìœ„í•´ ê¸°ë¡í•¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤</em></span></p>

<p><br /><br /></p>

<h1 id="api-ì„œë¹„ìŠ¤-ë§Œë“¤ê¸°"><center>API ì„œë¹„ìŠ¤ ë§Œë“¤ê¸°</center></h1>

<p><br /></p>

<p>API ì„œë²„ëŠ” ì‰½ê²Œ ë§í•´ì„œ ìˆœìˆ˜í•˜ê²Œ ì›í•˜ëŠ” ë°ì´í„°ë§Œì„ ì œê³µí•˜ëŠ” ì„œë²„ë¼ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤. ë°ì´í„°ë§Œ ì œê³µí•˜ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ì˜ ê¸°ìˆ ì´ ì–´ë–»ê²Œ ì´ë£¨ì–´ ì§€ëŠ”ì§€ëŠ” ì¤‘ìš”í•˜ì§€ ì•Šê³  ì„œë²„ì˜ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ í˜•íƒœë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><br /></p>

<p>ì˜ˆì œì—ì„œëŠ” ê°„ë‹¨í•œ Noteë¥¼ ì‘ì„±í•˜ê³  ì´ìš©í•˜ëŠ” ì˜ˆì œë¥¼ êµ¬ì„±í•œë‹¤. ì´ë¥¼ ìœ„í•´ ê°€ì¥ ë¨¼ì € í•´ì•¼ í•˜ëŠ” ì¼ì€ ë‹¨ìˆœíˆ JSON ì²˜ë¦¬ë¥¼ í•˜ëŠ” API ê¸°ëŠ¥ì„ êµ¬ì„±í•œë‹¤. í”„ë¡œì íŠ¸ì— entity íŒ¨í‚¤ì§€ ë‚´ì— Note ì—”í‹°í‹° í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•œë‹¤.</p>

<p><br /></p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-12.1/2021-08-08-17-36-18.png" alt="" /></p>

<p><br /></p>

<p><strong>Note.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.entity</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.persistence.*</span><span class="o">;</span>

<span class="nd">@Entity</span>
<span class="nd">@Builder</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Getter</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Note</span> <span class="kd">extends</span> <span class="nc">BaseEntity</span><span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span><span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">num</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span><span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">ClubMember</span> <span class="n">writer</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeTitle</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">title</span><span class="o">=</span><span class="n">title</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeContent</span><span class="o">(</span><span class="nc">String</span> <span class="n">content</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">content</span><span class="o">=</span><span class="n">content</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p>Note í´ë˜ìŠ¤ëŠ” Clubmemberì™€ @ManyToOneì˜ ê´€ê³„ë¡œ êµ¬ì„±í•˜ê³ , ë‚˜ì¤‘ì— ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì™€ ë¹„êµí•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤. Noteì—ì„œ ìˆ˜ì •ì´ ê°€ëŠ¥í•œ ë¶€ë¶„ì€ ì œëª©(title)ê³¼ ë‚´ìš©(content)ì´ë¯€ë¡œ ì´ì— ëŒ€í•œ ìˆ˜ì •ì´ ê°€ëŠ¥í•˜ë„ë¡ changetitle(), changeContent()ë¥¼ êµ¬ì„±í•œë‹¤. Noteì— ëŒ€í•œ JPA ì²˜ë¦¬ëŠ” NoteRepositoryë¥¼ êµ¬ì„±í•œë‹¤.</p>

<p><br /></p>

<p><img src="../images/SpringBoot/LearningSpringbootWithWebProject-12.1/2021-08-08-17-44-27.png" alt="" /></p>

<p><br /></p>

<p><strong>NoteRepository.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.repository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.repository.EntityGraph</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.repository.JpaRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.repository.Query</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.young.club.entity.Note</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Optional</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">NoteRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Note</span><span class="o">,</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="cm">/*
        @EntityGraphëŠ” ì—”í‹°í‹°ì˜ íŠ¹ì •í•œ ì†ì„±ì„ ê°™ì´ ë¡œë”©í•˜ë„ë¡ í‘œì‹œí•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ JPAë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” ì—°ê´€ ê´€ê³„ì˜ FATCH ì†ì„±ê°’ì€ LAZYë¡œ ì§€ì •í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤.
        @EntityGraphëŠ” ì´ëŸ¬í•œ ìƒí™©ì—ì„œ íŠ¹ì • ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ë•Œë§Œ EAGER ë¡œë”©ì„ í•˜ë„ë¡ ì§€ì •í•  ìˆ˜ ìˆë‹¤.
        @EntityGraphëŠ” attributePaths ì†ì„±ê³¼ type ì†ì„±ì„ ê°€ì§€ê³  ìˆë‹¤.

        attributePaths: ë¡œë”© ì„¤ì •ì„ ë³€ê²½í•˜ê³  ì‹¶ì€ ì†ì„±ì˜ ì´ë¦„ì„ ë°°ì—´ë¡œ ëª…ì‹œí•œë‹¤.
        type: @EntityGraphë¥¼ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì ìš©í•  ê²ƒì¸ì§€ë¥¼ ì„¤ì •í•œë‹¤.
        FATCH ì†ì„±ê°’ì€ attributePathsì— ëª…ì‹œí•œ ì†ì„±ì€ EAGERë¡œ ì²˜ë¦¬í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” LAZYë¡œ ì²˜ë¦¬í•œë‹¤.
        LOAD ì†ì„±ê°’ì€ attributePathsì— ëª…ì‹œí•œ ì†ì„±ì€ EAGERë¡œ ì²˜ë¦¬í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ì—”í‹°í‹° í´ë˜ìŠ¤ì— ëª…ì‹œë˜ê±°ë‚˜ ê¸°ë³¸ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤.
    */</span>
    <span class="c1">//ì—¬ê¸°ì„œëŠ” Noteë¥¼ ì§ˆì˜í•  ë•Œ ClubMemberë„ ê°™ì´ ë¡œë”©í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.</span>
    <span class="nd">@EntityGraph</span><span class="o">(</span><span class="n">attributePaths</span><span class="o">=</span><span class="s">"writer"</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="nc">EntityGraph</span><span class="o">.</span><span class="na">EntityGraphType</span><span class="o">.</span><span class="na">LOAD</span><span class="o">)</span>
    <span class="nd">@Query</span><span class="o">(</span><span class="s">"select n from Note n where n.num=:num"</span><span class="o">)</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Note</span><span class="o">&gt;</span> <span class="nf">getWithWrtier</span><span class="o">(</span><span class="nc">Long</span> <span class="n">num</span><span class="o">);</span>

    <span class="nd">@EntityGraph</span><span class="o">(</span><span class="n">attributePaths</span> <span class="o">=</span> <span class="o">{</span><span class="s">"writer"</span><span class="o">},</span> <span class="n">type</span><span class="o">=</span><span class="nc">EntityGraph</span><span class="o">.</span><span class="na">EntityGraphType</span><span class="o">.</span><span class="na">LOAD</span><span class="o">)</span>
    <span class="nd">@Query</span><span class="o">(</span><span class="s">"select n from Note n where n.writer.email=:email"</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Note</span><span class="o">&gt;</span> <span class="nf">getList</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div></div>

<p><br /></p>

<link rel="stylesheet" href="https: //www.webnots.com/resources/font-awesome/css/font-awesome.min.css" />

<link rel="stylesheet" href="/assets/css/webnots.css" />

<div class="webnots-information webnots-notification-box">ClubMemberë¥¼ @EntityGraphë¥¼ ì‚¬ìš©í•´ì„œ ì²˜ë¦¬í•  ë•Œ ClubMemberì˜ roleSetì´ toString()ì— ì‚¬ìš©ë˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•œë‹¤. ë§Œì¼ roleSetê¹Œì§€ ê°™ì´ ë¡œë”©í•˜ê³  ì‹¶ë‹¤ë©´ attributePaths={"writer", "writer.roleSet"}ê³¼ ê°™ì´ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. </div>

<p><br /></p>

<p>Note ì—”í‹°í‹°ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•´ì„œ ì¤‘ê°„ì— NoteDTOë¥¼ êµ¬ì„±í•˜ê³ , ì´ë¥¼ ì´ìš”í•˜ëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µì„ ì„¤ê³„í•´ ë³¸ë‹¤. í”„ë¡œì íŠ¸ ë‚´ì— dto íŒ¨í‚¤ì§€ë¥¼ êµ¬ì„±í•˜ê³  NoteDTOë¥¼ êµ¬ì„±í•œë‹¤.</p>

<p><br /></p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-12.1/2021-08-08-18-02-36.png" alt="" /></p>

<p><br /></p>

<p><strong>NoteDTO.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.security.dto</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">lombok.AllArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Builder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoteDTO</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">num</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">writerEmail</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">regDate</span><span class="o">,</span> <span class="n">modDate</span><span class="o">;</span>
<span class="o">}</span>

</code></pre></div></div>

<p><br /></p>

<p>í”„ë¡œì íŠ¸ì— service íŒ¨í‚¤ì§€ë¥¼ êµ¬ì„±í•˜ê³ , NoteServiceì™€ NoteServiceImpl í´ë˜ìŠ¤ë¥¼ êµ¬ì„±í•œë‹¤.</p>

<p><br /></p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-12.1/2021-08-08-18-23-36.png" alt="" /></p>

<p><br /></p>

<p><strong>NoteDTO.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.security.dto</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">lombok.AllArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Builder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoteDTO</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">num</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">writerEmail</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">regDate</span><span class="o">,</span> <span class="n">modDate</span><span class="o">;</span>
<span class="o">}</span>

</code></pre></div></div>

<p><br /></p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-12.1/2021-08-08-18-25-35.png" alt="" /></p>

<p><br /></p>

<p><strong>NoteService.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.security.service</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">org.young.club.entity.ClubMember</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.young.club.entity.Note</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.young.club.security.dto.NoteDTO</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">NoteServiceImpl</span> <span class="o">{</span>
    <span class="nc">Long</span> <span class="nf">register</span><span class="o">(</span><span class="nc">NoteDTO</span> <span class="n">noteDTO</span><span class="o">);</span>

    <span class="nc">NoteDTO</span> <span class="nf">get</span><span class="o">(</span><span class="nc">Long</span> <span class="n">num</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">modify</span><span class="o">(</span><span class="nc">NoteDTO</span> <span class="n">noteDTO</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">remove</span><span class="o">(</span><span class="nc">Long</span> <span class="n">num</span><span class="o">);</span>

    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">NoteDTO</span><span class="o">&gt;</span> <span class="nf">getAllWithWriter</span><span class="o">(</span><span class="nc">String</span> <span class="n">writerEmail</span><span class="o">);</span>

    <span class="k">default</span> <span class="nc">Note</span> <span class="nf">dtoToEntity</span><span class="o">(</span><span class="nc">NoteDTO</span> <span class="n">noteDTO</span><span class="o">){</span>
        <span class="nc">Note</span> <span class="n">note</span><span class="o">=</span><span class="nc">Note</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">num</span><span class="o">(</span><span class="n">noteDTO</span><span class="o">.</span><span class="na">getNum</span><span class="o">())</span>
                <span class="o">.</span><span class="na">title</span><span class="o">(</span><span class="n">noteDTO</span><span class="o">.</span><span class="na">getTitle</span><span class="o">())</span>
                <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">noteDTO</span><span class="o">.</span><span class="na">getContent</span><span class="o">())</span>
                <span class="o">.</span><span class="na">writer</span><span class="o">(</span><span class="nc">ClubMember</span><span class="o">.</span><span class="na">builder</span><span class="o">().</span><span class="na">email</span><span class="o">(</span><span class="n">noteDTO</span><span class="o">.</span><span class="na">getWriterEmail</span><span class="o">()).</span><span class="na">build</span><span class="o">())</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">note</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">default</span> <span class="nc">NoteDTO</span> <span class="nf">entityToDTO</span><span class="o">(</span><span class="nc">Note</span> <span class="n">note</span><span class="o">){</span>
        <span class="nc">NoteDTO</span> <span class="n">noteDTO</span><span class="o">=</span><span class="nc">NoteDTO</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">num</span><span class="o">(</span><span class="n">note</span><span class="o">.</span><span class="na">getNum</span><span class="o">())</span>
                <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">note</span><span class="o">.</span><span class="na">getContent</span><span class="o">())</span>
                <span class="o">.</span><span class="na">writerEmail</span><span class="o">(</span><span class="n">note</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">getEmail</span><span class="o">())</span>
                <span class="o">.</span><span class="na">regDate</span><span class="o">(</span><span class="n">note</span><span class="o">.</span><span class="na">getRegDate</span><span class="o">())</span>
                <span class="o">.</span><span class="na">modDate</span><span class="o">(</span><span class="n">note</span><span class="o">.</span><span class="na">getModDate</span><span class="o">())</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">noteDTO</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p><br /></p>

<p>NoteService ì¸í„°í˜ì´ìŠ¤ëŠ” CRUD ê¸°ëŠ¥ê³¼ entityToDto(), dtoToEntity() ê¸°ëŠ¥ì„ êµ¬í˜„í•œë‹¤.</p>

<p><br /></p>

<p><strong>NoteServiceImpl.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.security.service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.RequiredArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.extern.log4j.Log4j2</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.young.club.entity.Note</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.young.club.repository.NoteRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.young.club.security.dto.NoteDTO</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Optional</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.Collectors</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="nd">@Log4j2</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoteService</span> <span class="kd">implements</span> <span class="nc">NoteServiceImpl</span><span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">NoteRepository</span> <span class="n">noteRepository</span><span class="o">;</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">register</span><span class="o">(</span><span class="nc">NoteDTO</span> <span class="n">noteDTO</span><span class="o">)</span> <span class="o">{</span> 
        <span class="nc">Note</span> <span class="n">note</span><span class="o">=</span><span class="n">dtoToEntity</span><span class="o">(</span><span class="n">noteDTO</span><span class="o">);</span>
        
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"================"</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">note</span><span class="o">);</span>
        <span class="n">noteRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">note</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">note</span><span class="o">.</span><span class="na">getNum</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">NoteDTO</span> <span class="nf">get</span><span class="o">(</span><span class="nc">Long</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Note</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">noteRepository</span><span class="o">.</span><span class="na">getWithWrtier</span><span class="o">(</span><span class="n">num</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span>
            <span class="k">return</span> <span class="nf">entityToDTO</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
        
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">modify</span><span class="o">(</span><span class="nc">NoteDTO</span> <span class="n">noteDTO</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Long</span> <span class="n">num</span><span class="o">=</span><span class="n">noteDTO</span><span class="o">.</span><span class="na">getNum</span><span class="o">();</span>
        
        <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Note</span><span class="o">&gt;</span> <span class="n">result</span><span class="o">=</span><span class="n">noteRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">num</span><span class="o">);</span>
        
        <span class="k">if</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">isPresent</span><span class="o">()){</span>
            <span class="nc">Note</span> <span class="n">note</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
            <span class="n">note</span><span class="o">.</span><span class="na">changeTitle</span><span class="o">(</span><span class="n">noteDTO</span><span class="o">.</span><span class="na">getTitle</span><span class="o">());</span>
            <span class="n">note</span><span class="o">.</span><span class="na">changeContent</span><span class="o">(</span><span class="n">noteDTO</span><span class="o">.</span><span class="na">getContent</span><span class="o">());</span>
            <span class="n">noteRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">note</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">(</span><span class="nc">Long</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">noteRepository</span><span class="o">.</span><span class="na">deleteById</span><span class="o">(</span><span class="n">num</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">NoteDTO</span><span class="o">&gt;</span> <span class="nf">getAllWithWriter</span><span class="o">(</span><span class="nc">String</span> <span class="n">writerEmail</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Note</span><span class="o">&gt;</span> <span class="n">noteList</span><span class="o">=</span><span class="n">noteRepository</span><span class="o">.</span><span class="na">getList</span><span class="o">(</span><span class="n">writerEmail</span><span class="o">);</span>
        
        <span class="k">return</span> <span class="n">noteList</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">map</span><span class="o">(</span><span class="n">note</span><span class="o">-&gt;</span><span class="n">entityToDTO</span><span class="o">(</span><span class="n">note</span><span class="o">)).</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p><br /></p>

<p>JSONìœ¼ë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” NoteControllerëŠ” @RestControllerë¥¼ ì‚¬ìš©í•´ì„œ êµ¬í˜„í•œë‹¤. êµ¬í˜„ ì‹œì—ëŠ” í™”ë©´ì´ ì—†ëŠ” ìƒíƒœì´ë¯€ë¡œ REST ë°©ì‹ì„ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” í¬ë¡¬ í™•ì¥ í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•œë‹¤. controller íŒ¨í‚¤ì§€ì— NoteControllerë¥¼ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•œë‹¤.</p>

<p><br /></p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-12.1/2021-08-08-18-41-47.png" alt="" /></p>

<p><br /></p>

<p>**</p>
:ET