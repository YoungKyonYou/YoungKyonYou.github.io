I"›<p><span style="color:orange; font-weight:bold"><em>í•´ë‹¹ ë‚´ìš©ì€ ì±… â€˜ì½”ë“œë¡œ ë°°ìš°ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ ì›¹ í”„ë¡œì íŠ¸â€™ì— ë‚˜ì˜¤ëŠ” ë‚´ìš©ì´ë©° ì´ëŠ” ê°œì¸ì ìœ¼ë¡œ ê³µë¶€í•˜ê¸° ìœ„í•´ ê¸°ë¡í•¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤</em></span></p>

<p><br /><br /></p>

<h1 id="í˜„ì¬-í”„ë¡œì íŠ¸ì™€ì˜-ì—°ë™"><center>í˜„ì¬ í”„ë¡œì íŠ¸ì™€ì˜ ì—°ë™</center></h1>

<p><br /></p>

<p>ì´ì œëŠ” ì•„ì‰¬ìš´ ì ë“¤ì„ ì°¾ì•„ì„œ ìˆ˜ì •í•´ë³¸ë‹¤.</p>

<p>ì•„ë˜ì™€ ê°™ì€ ì ë“¤ì„ ê³ ë ¤í•´ ë³¸ë‹¤.</p>

<link rel="stylesheet" href="https: //www.webnots.com/resources/font-awesome/css/font-awesome.min.css" />

<link rel="stylesheet" href="/assets/css/webnots.css" />

<div class="webnots-success webnots-notification-box">ì†Œì…œ ë¡œê·¸ì¸ ì²˜ë¦¬ ì‹œì— ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì •ë³´ë¥¼ ì¶”ì¶œí•œë‹¤.</div>
<div class="webnots-success webnots-notification-box">í˜„ì¬ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™í•´ì„œ ì‚¬ìš©ì ì •ë³´ë¥¼ ê´€ë¦¬í•´ì•¼ í•œë‹¤.</div>
<div class="webnots-success webnots-notification-box">ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œë„ ë¡œê·¸ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•˜ê³ , ì†Œì…œ ë¡œê·¸ì¸ìœ¼ë¡œë„ ë™ì¼í•˜ê²Œ ë™ì‘í•´ì•¼ í•œë‹¤. </div>

<p><br /></p>

<p>ê°€ì¥ ë¨¼ì € í•´ì•¼ í•˜ëŠ” ì‘ì—…ì€ êµ¬ê¸€ê³¼ ê°™ì€ ì„œë¹„ìŠ¤ì—ì„œ ë¡œê·¸ì¸ ì²˜ë¦¬ê°€ ëë‚œ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì‘ì—…ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ êµ¬ì„±í•˜ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ ìœ„í•´ì„œëŠ” ì‹¤ì œ ì†Œì…œ ë¡œê·¸ì¸ ê³¼ì •ì—ì„œ ë™ì‘í•˜ëŠ” ì¡´ì¬ì¸ <span style="color:orange; font-weight:bold">OAuth2UserService</span>ë¼ëŠ” ê²ƒì„ ì•Œì•„ì•¼ë§Œ í•œë‹¤.</p>

<p><br /></p>

<p><strong>org.springframework.security.oauth2.client.userinfo.OAuth2UserService ì¸í„°í˜ì´ìŠ¤</strong>ëŠ” <strong>UserDetailsService</strong>ì˜ <strong>OAuth</strong> ë²„ì „ì´ë¼ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì€ <strong>OAuthì˜ ì¸ì¦ ê²°ê³¼</strong>ë¥¼ ì²˜ë¦¬í•œë‹¤ëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<p>ì¸í„°í˜ì´ìŠ¤ë¥¼ ì§ì ‘ êµ¬í˜„í•  ìˆ˜ë„ ìˆì§€ë§Œ í¸í•˜ê²Œ í•˜ê³  ì‹¶ë‹¤ë©´ êµ¬í˜„ëœ í´ë˜ìŠ¤ ì¤‘ì—ì„œ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ ë” í¸í•  ê²ƒì´ë¯€ë¡œ <strong>DefaultOAuth2UserService</strong> í´ë˜ìŠ¤ë¥¼ ìƒì†í•´ì„œ êµ¬í˜„í•œë‹¤. security íŒ¨í‚¤ì§€ ë‚´ì— ìˆëŠ” service íŒ¨í‚¤ì§€ì— <strong>DefaultOAuth2UserService</strong>ë¥¼ ìƒì†í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ **ClubOAuth2UserDetailsServicesë¼ëŠ” í´ë˜ìŠ¤ë¡œ êµ¬ì„±í•œë‹¤.</p>

<p><br /></p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-11.2/2021-08-02-16-54-43.png" alt="" /></p>

<p><br /></p>

<p><strong>ClubOAuth2UserDetailsServices.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.security.service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.extern.log4j.Log4j2</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.client.userinfo.DefaultOAuth2UserService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.client.userinfo.OAuth2UserRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.core.OAuth2AuthenticationException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.core.user.OAuth2User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="nd">@Log4j2</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClubOAuth2UserDetailsService</span> <span class="kd">extends</span> <span class="nc">DefaultOAuth2UserService</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">OAuth2User</span> <span class="nf">loadUser</span><span class="o">(</span><span class="nc">OAuth2UserRequest</span> <span class="n">userRequest</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OAuth2AuthenticationException</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"---------------------------------------"</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"userRequest:"</span> <span class="o">+</span><span class="n">userRequest</span><span class="o">);</span>
        <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">loadUser</span><span class="o">(</span><span class="n">userRequest</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p><br /></p>

<p>í”„ë¡œì íŠ¸ë¥¼ ì¬ì‹œì‘í•œ í›„ì— â€˜/sample/memberâ€™ë¡œ ë¡œê·¸ì¸ì„ ì‹œë„í•˜ë©´ ìœ„ì˜ ì½”ë“œê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-11.2/2021-08-02-17-00-56.png" alt="" /></p>

<p><br /></p>

<p><span style="color:#85144b; font-weight:bold; font-size:30px">ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì¶”ì¶œ</span></p>

<p>loadUser()ì—ì„œ ì‚¬ìš©í•˜ëŠ” OAuth2UserRequestëŠ” í˜„ì¬ ì–´ë–¤ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ì„œ ë¡œê·¸ì¸ì´ ì´ë£¨ì–´ì¡ŒëŠ”ì§€ ì•Œì•„ë‚´ê³  ì „ë‹¬ëœ ê°’ë“¤ì„ ì¶”ì¶œí•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ Map&lt;String, Object&gt;ì˜ í˜•íƒœë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ìµœëŒ€í•œ ë§ì€ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•´ì„œ ClubOAuth2UserDetailsServiceì˜ loadUser()ë¥¼ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•œë‹¤.</p>

<p><strong>ClubOAuth2UserDetailsServices.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.security.service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.extern.log4j.Log4j2</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.client.userinfo.DefaultOAuth2UserService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.client.userinfo.OAuth2UserRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.core.OAuth2AuthenticationException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.core.user.OAuth2User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="nd">@Log4j2</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClubOAuth2UserDetailsService</span> <span class="kd">extends</span> <span class="nc">DefaultOAuth2UserService</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">OAuth2User</span> <span class="nf">loadUser</span><span class="o">(</span><span class="nc">OAuth2UserRequest</span> <span class="n">userRequest</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OAuth2AuthenticationException</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"---------------------------------------"</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"userRequest:"</span> <span class="o">+</span><span class="n">userRequest</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">clientName</span><span class="o">=</span><span class="n">userRequest</span><span class="o">.</span><span class="na">getClientRegistration</span><span class="o">().</span><span class="na">getClientName</span><span class="o">();</span>

        <span class="c1">//OAuthë¡œ ì—°ê²°í•œ í´ë¼ì´ì–¸íŠ¸ ì´ë¦„ê³¼ ì´ë•Œ ì‚¬ìš©í•œ íŒŒë¼ë¯¸í„°ë“¤ì„ ì¶œë ¥í•œë‹¤.</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"clientName: "</span><span class="o">+</span><span class="n">clientName</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">userRequest</span><span class="o">.</span><span class="na">getAdditionalParameters</span><span class="o">());</span>

        <span class="c1">//DefaultOAuth2UserServiceì˜ loadUser()ëŠ” OAuth2UserRequestë¼ëŠ” íƒ€ì…ì˜ íŒŒë¼ë¯¸í„°ì™€ OAuth2User</span>
        <span class="c1">//ë¼ëŠ” íƒ€ì…ì˜ ë¦¬í„´ íƒ€ì…ì„ ë°˜í™˜í•œë‹¤.</span>
        <span class="nc">OAuth2User</span> <span class="n">oAuth2User</span><span class="o">=</span><span class="kd">super</span><span class="o">.</span><span class="na">loadUser</span><span class="o">(</span><span class="n">userRequest</span><span class="o">);</span>

        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"========================"</span><span class="o">);</span>

        <span class="c1">//loadUser()ì—ì„œ ì‚¬ìš©í•˜ëŠ” OAuth2UserRequestëŠ” í˜„ì¬ ì–´ë–¤ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ì„œ ë¡œê·¸ì¸ì´ ì´ë£¨ì–´ì¡ŒëŠ”ì§€</span>
        <span class="c1">//ì•Œì•„ë‚´ê³  ì „ë‹¬ëœ ê°’ë“¤ì„ ì¶”ì¶œí•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ Map&lt;String, Object&gt;ì˜ í˜•íƒœë¡œ</span>
        <span class="c1">//ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ìµœëŒ€í•œ ë§ì€ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</span>
        <span class="n">oAuth2User</span><span class="o">.</span><span class="na">getAttributes</span><span class="o">().</span><span class="na">forEach</span><span class="o">((</span><span class="n">k</span><span class="o">,</span><span class="n">v</span><span class="o">)-&gt;{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">k</span><span class="o">+</span><span class="s">":"</span><span class="o">+</span><span class="n">v</span><span class="o">);</span>
        <span class="o">});</span>
        <span class="k">return</span> <span class="n">oAuth2User</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p><br /></p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-11.2/2021-08-02-17-23-54.png" alt="" /></p>

<p><br /></p>

<p>ìœ„ì˜ ì½”ë“œë¥¼ ì´ìš©í•œ ê²°ê³¼ë¡œ ì¶œë ¥ë˜ëŠ” ë‚´ìš©ì€ êµ¬ê¸€ì—ì„œ í”„ë¡œì íŠ¸ë¥¼ ë“±ë¡í•˜ë©´ì„œ ì§€ì •í•œ â€˜API ë²”ìœ„â€™ì˜ í•­ëª©ê³¼ <strong>application-oauth.properties</strong> ì„¤ì • íŒŒì¼ê³¼ ê´€ë ¨ì´ ìˆë‹¤.</p>

<p><br /></p>

<p>ìœ„ì˜ ì‚¬ì§„ì—ì„œ sub, picture, email, email_verified í•­ëª©ì´ ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ìœ„ì™€ ê°™ì´ <strong>OAuth2User</strong>ë¥¼ ì´ìš©í•˜ë©´ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì•Œì•„ë‚¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë‚¨ì€ ì‘ì—…ì€ ì´ë¥¼ ì´ìš©í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ì¶”ê°€í•˜ëŠ” ì‘ì—…ì„ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.</p>

<div class="webnots-success webnots-notification-box">ì´ë©”ì¼ì€ ë¬¸ì œê°€ ì—†ì§€ë§Œ íŒ¨ìŠ¤ì›Œë“œë‚˜ ì‚¬ìš©ìì˜ ì´ë¦„ ë“±ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì¶”ê°€í•˜ëŠ” ì‘ì—…ì€ ê³ ë¯¼ì„ ì¢€ í•´ì•¼ í•œë‹¤.</div>

<p><br /></p>

<p>ì„ì˜ë¡œ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì§€ì •í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ê²½ìš° ë‚˜ì¤‘ì— ë¬¸ì œê°€ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ì´ì— ëŒ€í•œ ë…¼ì˜ëŠ” ì¡°ê¸ˆ ë¯¸ë£¬ë‹¤. ìš°ì„ ì€ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.</p>

<p><br /></p>

<p><strong>ClubOAuth2UserDetailsService.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.security.service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.RequiredArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.extern.log4j.Log4j2</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.crypto.password.PasswordEncoder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.client.userinfo.DefaultOAuth2UserService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.client.userinfo.OAuth2UserRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.core.OAuth2AuthenticationException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.core.user.OAuth2User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.young.club.entity.ClubMember</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.young.club.entity.ClubMemberRole</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.young.club.repository.ClubMemberRepository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Optional</span><span class="o">;</span>

<span class="nd">@Log4j2</span>
<span class="nd">@Service</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClubOAuth2UserDetailsService</span> <span class="kd">extends</span> <span class="nc">DefaultOAuth2UserService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ClubMemberRepository</span> <span class="n">repository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">;</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">OAuth2User</span> <span class="nf">loadUser</span><span class="o">(</span><span class="nc">OAuth2UserRequest</span> <span class="n">userRequest</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OAuth2AuthenticationException</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"---------------------------------------"</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"userRequest:"</span> <span class="o">+</span><span class="n">userRequest</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">clientName</span><span class="o">=</span><span class="n">userRequest</span><span class="o">.</span><span class="na">getClientRegistration</span><span class="o">().</span><span class="na">getClientName</span><span class="o">();</span>

        <span class="c1">//OAuthë¡œ ì—°ê²°í•œ í´ë¼ì´ì–¸íŠ¸ ì´ë¦„ê³¼ ì´ë•Œ ì‚¬ìš©í•œ íŒŒë¼ë¯¸í„°ë“¤ì„ ì¶œë ¥í•œë‹¤.</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"clientName: "</span><span class="o">+</span><span class="n">clientName</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">userRequest</span><span class="o">.</span><span class="na">getAdditionalParameters</span><span class="o">());</span>

        <span class="c1">//DefaultOAuth2UserServiceì˜ loadUser()ëŠ” OAuth2UserRequestë¼ëŠ” íƒ€ì…ì˜ íŒŒë¼ë¯¸í„°ì™€ OAuth2User</span>
        <span class="c1">//ë¼ëŠ” íƒ€ì…ì˜ ë¦¬í„´ íƒ€ì…ì„ ë°˜í™˜í•œë‹¤.</span>
        <span class="nc">OAuth2User</span> <span class="n">oAuth2User</span><span class="o">=</span><span class="kd">super</span><span class="o">.</span><span class="na">loadUser</span><span class="o">(</span><span class="n">userRequest</span><span class="o">);</span>

        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"========================"</span><span class="o">);</span>

        <span class="c1">//loadUser()ì—ì„œ ì‚¬ìš©í•˜ëŠ” OAuth2UserRequestëŠ” í˜„ì¬ ì–´ë–¤ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ì„œ ë¡œê·¸ì¸ì´ ì´ë£¨ì–´ì¡ŒëŠ”ì§€</span>
        <span class="c1">//ì•Œì•„ë‚´ê³  ì „ë‹¬ëœ ê°’ë“¤ì„ ì¶”ì¶œí•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ Map&lt;String, Object&gt;ì˜ í˜•íƒœë¡œ</span>
        <span class="c1">//ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ìµœëŒ€í•œ ë§ì€ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</span>
        <span class="n">oAuth2User</span><span class="o">.</span><span class="na">getAttributes</span><span class="o">().</span><span class="na">forEach</span><span class="o">((</span><span class="n">k</span><span class="o">,</span><span class="n">v</span><span class="o">)-&gt;{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">k</span><span class="o">+</span><span class="s">":"</span><span class="o">+</span><span class="n">v</span><span class="o">);</span>
        <span class="o">});</span>

        <span class="nc">String</span> <span class="n">email</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>

        <span class="c1">//ì´ë©”ì¼ ì •ë³´ ì¶”ì¶œ</span>
        <span class="k">if</span><span class="o">(</span><span class="n">clientName</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Google"</span><span class="o">)){</span>
            <span class="n">email</span><span class="o">=</span><span class="n">oAuth2User</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">"email"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"EMAIL: "</span><span class="o">+</span><span class="n">email</span><span class="o">);</span>

        <span class="nc">ClubMember</span> <span class="n">member</span><span class="o">=</span><span class="n">saveSocialMember</span><span class="o">(</span><span class="n">email</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">oAuth2User</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//ClubMemberRepositoryë¥¼ ì´ìš©í•´ì„œ ì†Œì…œ ë¡œê·¸ì¸í•œ ì´ë©”ì¼ì„ ì²˜ë¦¬í•˜ëŠ” ë¶€ë¶„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</span>
    <span class="kd">private</span> <span class="nc">ClubMember</span> <span class="nf">saveSocialMember</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">){</span>
        <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">ClubMember</span><span class="o">&gt;</span> <span class="n">result</span><span class="o">=</span><span class="n">repository</span><span class="o">.</span><span class="na">findByEmail</span><span class="o">(</span><span class="n">email</span><span class="o">,</span><span class="kc">true</span><span class="o">);</span>

        <span class="c1">//ì¶”ì¶œëœ ì´ë©”ì¼ ì£¼ì†Œë¡œ í˜„ì¬ ë°ì´í„°ë² ì´ìŠ¤ì— ìˆëŠ” ì‚¬ìš©ìê°€ ì•„ë‹ˆë¼ë©´ ìë™ìœ¼ë¡œ íšŒì› ê°€ì…ì„ ì²˜ë¦¬í•œë‹¤.</span>
        <span class="k">if</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">isPresent</span><span class="o">()){</span>
            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="nc">ClubMember</span> <span class="n">clubMember</span><span class="o">=</span><span class="nc">ClubMember</span><span class="o">.</span><span class="na">builder</span><span class="o">().</span><span class="na">email</span><span class="o">(</span><span class="n">email</span><span class="o">)</span>
                <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="n">email</span><span class="o">)</span>
                <span class="o">.</span><span class="na">password</span><span class="o">(</span><span class="n">passwordEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="s">"1111"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">fromSocial</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="n">clubMember</span><span class="o">.</span><span class="na">addMemberRole</span><span class="o">(</span><span class="nc">ClubMemberRole</span><span class="o">.</span><span class="na">USER</span><span class="o">);</span>
        <span class="n">repository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">clubMember</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">clubMember</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p><br /></p>

<p>DefaultOAuth2UserServiceì˜ loadUser()ì˜ ê²½ìš° ì¼ë°˜ì ì¸ ë¡œê·¸ì¸ê³¼ ë‹¤ë¥´ê²Œ OAuth2User íƒ€ì…ì˜ ê°ì²´ë¥¼ ë°˜í™˜í•´ì•¼ í•˜ëŠ”ë° ì§€ê¸ˆê¹Œì§€ ê°œë°œí–ˆë˜ ì½”ë“œë¡œëŠ” í™”ë©´ì—ì„œ ì•„ë˜ì™€ ê°™ì´ ë©”ì¼ ì£¼ì†Œê°€ ì•„ë‹Œ ì‚¬ìš©ìì˜ ë²ˆí˜¸ê°€ ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-11.2/2021-08-02-17-46-49.png" alt="" /></p>

<p><br /></p>

<p>ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œë„ ë™ì¼í•˜ê²Œ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ”ë° ì•ì—ì„œ ë§Œë“¤ì–´ì§„ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” íŒŒë¼ë¯¸í„°ë¡œ ClubAuthMemberDTO íƒ€ì…ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì†Œì…œ ë¡œê·¸ì¸ì„ í•˜ëŠ” ê²½ìš°ì—ëŠ” nullì´ë¼ëŠ” ê²°ê³¼ê°€ ë°œìƒí•œë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” OAuth2User íƒ€ì…ì„ ClubAuthMemberDTO íƒ€ì…ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬í•´ ì¤„ í•„ìš”ê°€ ìˆë‹¤. ë‹¤í–‰íˆë„ OAuth2User íƒ€ì…ì€ ì¸í„°í˜ì´ìŠ¤ë¡œ ì„¤ê³„ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ClubAuthMemberDTOë¥¼ ìˆ˜ì •í•´ì„œ ì´ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤.</p>

<p><br /></p>

<p><strong>ClubAuthMemberDTO.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.security.dto</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.extern.log4j.Log4j2</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.core.GrantedAuthority</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.core.userdetails.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.core.user.OAuth2User</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="nd">@Log4j2</span>
<span class="c1">//User í´ë˜ìŠ¤ëŠ” UserDetailsServiceë¡œë¶€í„° í•µì‹¬ ìœ ì € ì •ë³´ë¥¼ ëª¨ë¸ë§í•œë‹¤.</span>
<span class="c1">//User í´ë˜ìŠ¤ë¥¼ ìƒì†í•˜ê³  ë¶€ëª¨ í´ë˜ìŠ¤ì¸ User í´ë˜ìŠ¤ì˜ ìƒì„±ìë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” ì½”ë“œë¥¼ ë§Œë“ ë‹¤.</span>
<span class="c1">//ë¶€ëª¨ í´ë˜ìŠ¤ì¸ User í´ë˜ìŠ¤ì— ì‚¬ìš©ì ì •ì˜ ìƒì„±ìê°€ ìˆìœ¼ë¯€ë¡œ ë°˜ë“œì‹œ í˜¸ì¶œí•  í•„ìš”ê°€ ìˆë‹¤.</span>

<span class="c1">//ClubAuthMemberDTOëŠ” DTO ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” í´ë˜ìŠ¤ì¸ ë™ì‹œì— ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œ ì¸ê°€/ì¸ì¦ ì‘ì—…ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</span>
<span class="c1">//passwordëŠ” ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ë³„ë„ì˜ ë©¤ë²„ ë³€ìˆ˜ë¡œ ì„ ì–¸í•˜ì§€ ì•ŠëŠ”ë‹¤.</span>
<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClubAuthMemberDTO</span> <span class="kd">extends</span> <span class="nc">User</span> <span class="kd">implements</span> <span class="nc">OAuth2User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">fromSocial</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">attr</span><span class="o">;</span>

    <span class="c1">//OAuth2UserëŠ” Map íƒ€ì…ìœ¼ë¡œ ëª¨ë“  ì¸ì¦ ê²°ê³¼ë¥¼ attributesë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì—</span>
    <span class="c1">// ClubAuthMember ì—­ì‹œ attrì´ë¼ëŠ” ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ì£¼ê³  getAttribute() ë©”ì„œë“œë¥¼ overrideí•œ ì ì´ë‹¤.</span>
    <span class="kd">public</span> <span class="nf">ClubAuthMemberDTO</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">fromSocial</span><span class="o">,</span> <span class="nc">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">GrantedAuthority</span><span class="o">&gt;</span> <span class="n">authorities</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">attr</span><span class="o">){</span>
        <span class="k">this</span><span class="o">(</span><span class="n">username</span><span class="o">,</span><span class="n">password</span><span class="o">,</span> <span class="n">fromSocial</span><span class="o">,</span> <span class="n">authorities</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">attr</span><span class="o">=</span><span class="n">attr</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">ClubAuthMemberDTO</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">fromSocial</span><span class="o">,</span> <span class="nc">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">GrantedAuthority</span><span class="o">&gt;</span> <span class="n">authorities</span><span class="o">){</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">,</span> <span class="n">authorities</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">email</span><span class="o">=</span><span class="n">username</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">password</span><span class="o">=</span><span class="n">password</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">fromSocial</span><span class="o">=</span><span class="n">fromSocial</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">getAttributes</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">attr</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p><br /></p>

<p>loadUser()ì˜ ë‚´ë¶€ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•œë‹¤.</p>

<p><strong>ClubOAuth2UserDetailsService.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(...)</span>
<span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">OAuth2User</span> <span class="nf">loadUser</span><span class="o">(</span><span class="nc">OAuth2UserRequest</span> <span class="n">userRequest</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OAuth2AuthenticationException</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"---------------------------------------"</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"userRequest:"</span> <span class="o">+</span><span class="n">userRequest</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">clientName</span><span class="o">=</span><span class="n">userRequest</span><span class="o">.</span><span class="na">getClientRegistration</span><span class="o">().</span><span class="na">getClientName</span><span class="o">();</span>

        <span class="c1">//OAuthë¡œ ì—°ê²°í•œ í´ë¼ì´ì–¸íŠ¸ ì´ë¦„ê³¼ ì´ë•Œ ì‚¬ìš©í•œ íŒŒë¼ë¯¸í„°ë“¤ì„ ì¶œë ¥í•œë‹¤.</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"clientName: "</span><span class="o">+</span><span class="n">clientName</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">userRequest</span><span class="o">.</span><span class="na">getAdditionalParameters</span><span class="o">());</span>

        <span class="c1">//DefaultOAuth2UserServiceì˜ loadUser()ëŠ” OAuth2UserRequestë¼ëŠ” íƒ€ì…ì˜ íŒŒë¼ë¯¸í„°ì™€ OAuth2User</span>
        <span class="c1">//ë¼ëŠ” íƒ€ì…ì˜ ë¦¬í„´ íƒ€ì…ì„ ë°˜í™˜í•œë‹¤.</span>
        <span class="nc">OAuth2User</span> <span class="n">oAuth2User</span><span class="o">=</span><span class="kd">super</span><span class="o">.</span><span class="na">loadUser</span><span class="o">(</span><span class="n">userRequest</span><span class="o">);</span>

        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"========================"</span><span class="o">);</span>

        <span class="c1">//loadUser()ì—ì„œ ì‚¬ìš©í•˜ëŠ” OAuth2UserRequestëŠ” í˜„ì¬ ì–´ë–¤ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ì„œ ë¡œê·¸ì¸ì´ ì´ë£¨ì–´ì¡ŒëŠ”ì§€</span>
        <span class="c1">//ì•Œì•„ë‚´ê³  ì „ë‹¬ëœ ê°’ë“¤ì„ ì¶”ì¶œí•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ Map&lt;String, Object&gt;ì˜ í˜•íƒœë¡œ</span>
        <span class="c1">//ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ìµœëŒ€í•œ ë§ì€ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</span>
        <span class="n">oAuth2User</span><span class="o">.</span><span class="na">getAttributes</span><span class="o">().</span><span class="na">forEach</span><span class="o">((</span><span class="n">k</span><span class="o">,</span><span class="n">v</span><span class="o">)-&gt;{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">k</span><span class="o">+</span><span class="s">":"</span><span class="o">+</span><span class="n">v</span><span class="o">);</span>
        <span class="o">});</span>

        <span class="nc">String</span> <span class="n">email</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>

        <span class="c1">//ì´ë©”ì¼ ì •ë³´ ì¶”ì¶œ</span>
        <span class="k">if</span><span class="o">(</span><span class="n">clientName</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Google"</span><span class="o">)){</span>
            <span class="n">email</span><span class="o">=</span><span class="n">oAuth2User</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">"email"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"EMAIL: "</span><span class="o">+</span><span class="n">email</span><span class="o">);</span>
        <span class="c1">//ì¡°ê¸ˆ ë’¤ì— ì‚¬ìš©</span>
       <span class="c1">// ClubMember member=saveSocialMember(email);</span>
      <span class="c1">//  return oAuth2User;</span>
        <span class="nc">ClubMember</span> <span class="n">member</span><span class="o">=</span><span class="n">saveSocialMember</span><span class="o">(</span><span class="n">email</span><span class="o">);</span>
        <span class="nc">ClubAuthMemberDTO</span> <span class="n">clubAuthMember</span><span class="o">=</span><span class="k">new</span> <span class="nc">ClubAuthMemberDTO</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getEmail</span><span class="o">(),</span><span class="n">member</span><span class="o">.</span><span class="na">getPassword</span><span class="o">(),</span><span class="kc">true</span><span class="o">,</span><span class="n">member</span><span class="o">.</span><span class="na">getRoleSet</span><span class="o">().</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">role</span><span class="o">-&gt;</span><span class="k">new</span> <span class="nc">SimpleGrantedAuthority</span><span class="o">(</span><span class="s">"ROLE_"</span><span class="o">+</span><span class="n">role</span><span class="o">.</span><span class="na">name</span><span class="o">()))</span>
        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()),</span>
                <span class="n">oAuth2User</span><span class="o">.</span><span class="na">getAttributes</span><span class="o">());</span>
        <span class="n">clubAuthMember</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">clubAuthMember</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//ClubMemberRepositoryë¥¼ ì´ìš©í•´ì„œ ì†Œì…œ ë¡œê·¸ì¸í•œ ì´ë©”ì¼ì„ ì²˜ë¦¬í•˜ëŠ” ë¶€ë¶„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</span>
    <span class="kd">private</span> <span class="nc">ClubMember</span> <span class="nf">saveSocialMember</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">){</span>
        <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">ClubMember</span><span class="o">&gt;</span> <span class="n">result</span><span class="o">=</span><span class="n">repository</span><span class="o">.</span><span class="na">findByEmail</span><span class="o">(</span><span class="n">email</span><span class="o">,</span><span class="kc">true</span><span class="o">);</span>

        <span class="c1">//ì¶”ì¶œëœ ì´ë©”ì¼ ì£¼ì†Œë¡œ í˜„ì¬ ë°ì´í„°ë² ì´ìŠ¤ì— ìˆëŠ” ì‚¬ìš©ìê°€ ì•„ë‹ˆë¼ë©´ ìë™ìœ¼ë¡œ íšŒì› ê°€ì…ì„ ì²˜ë¦¬í•œë‹¤.</span>
        <span class="k">if</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">isPresent</span><span class="o">()){</span>
            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="nc">ClubMember</span> <span class="n">clubMember</span><span class="o">=</span><span class="nc">ClubMember</span><span class="o">.</span><span class="na">builder</span><span class="o">().</span><span class="na">email</span><span class="o">(</span><span class="n">email</span><span class="o">)</span>
                <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="n">email</span><span class="o">)</span>
                <span class="o">.</span><span class="na">password</span><span class="o">(</span><span class="n">passwordEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="s">"1111"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">fromSocial</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="n">clubMember</span><span class="o">.</span><span class="na">addMemberRole</span><span class="o">(</span><span class="nc">ClubMemberRole</span><span class="o">.</span><span class="na">USER</span><span class="o">);</span>
        <span class="n">repository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">clubMember</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">clubMember</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p>loadUser()ì—ì„œ ê°€ì¥ ë‹¬ë¼ì§€ëŠ” ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<div class="webnots-success webnots-notification-box">saveSocialMember()í•œ ê²°ê³¼ë¡œ ë‚˜ì˜¤ëŠ” ClubMemberë¥¼ ì´ìš©í•´ì„œ ClubAuthMemberDTOë¥¼ êµ¬ì„±í•œë‹¤.</div>
<div class="webnots-success webnots-notification-box">OAuth2Userì˜ ëª¨ë“  ë°ì´í„°ëŠ” ClubAuthMemberDTOì˜ ë‚´ë¶€ë¡œ ì „ë‹¬í•´ì„œ í•„ìš”í•œ ìˆœê°„ì— ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.</div>

<p><br /></p>

<p>ìœ„ì˜¤ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§„ í›„ì— êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ â€˜/sample/memberâ€™ë¥¼ ì‹œë„í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ êµ¬ê¸€ ê³„ì •ì„ ì´ìš©í•˜ë”ë¼ë„ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>

<p><br /></p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-11.2/2021-08-02-18-00-32.png" alt="" /></p>
:ET