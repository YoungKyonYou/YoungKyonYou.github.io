I"ö<p><span style="color:orange; font-weight:bold"><em>í•´ë‹¹ ë‚´ìš©ì€ ì±… â€˜ì½”ë“œë¡œ ë°°ìš°ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ ì›¹ í”„ë¡œì íŠ¸â€™ì— ë‚˜ì˜¤ëŠ” ë‚´ìš©ì´ë©° ì´ëŠ” ê°œì¸ì ìœ¼ë¡œ ê³µë¶€í•˜ê¸° ìœ„í•´ ê¸°ë¡í•¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤</em></span></p>

<p><br /><br /></p>

<h1 id="í˜„ì¬-í”„ë¡œì íŠ¸ì™€ì˜-ì—°ë™"><center>í˜„ì¬ í”„ë¡œì íŠ¸ì™€ì˜ ì—°ë™</center></h1>

<p><br /></p>

<p>ì´ì œëŠ” ì•„ì‰¬ìš´ ì ë“¤ì„ ì°¾ì•„ì„œ ìˆ˜ì •í•´ë³¸ë‹¤.</p>

<p>ì•„ë˜ì™€ ê°™ì€ ì ë“¤ì„ ê³ ë ¤í•´ ë³¸ë‹¤.</p>

<link rel="stylesheet" href="https: //www.webnots.com/resources/font-awesome/css/font-awesome.min.css" />

<style>
.webnots-notification-box {
-moz-border-radius: 5px;
-webkit-border-radius: 5px;
border-radius: 5px;
color: #ffffff;
font-family: verdana, 'open sans', sans-serif;
margin-bottom: 25px;
padding: 10px 14px 10px 44px;
position: relative;
box-shadow: 0px 1px 5px #999;
/* width: -moz-fit-content;
width: -webkit-fit-content;
width: fit-content; */
}
.webnots-notification-box:before {
font-family: FontAwesome;
font-size: 21px;
left: 14px;
position: absolute;
}
.webnots-success {
background-color: #2ecc71;
}
.webnots-success:before {
content: "\f00c";
margin-left: -2px;
}
.webnots-failure {
background-color: #e74c3c;
}
.webnots-failure:before {
content: "\f00d";
}
.webnots-warning {
background-color: #e67e22;
}
.webnots-warning:before {
content: "\f12a";
margin-left: 5px;
}
.webnots-information {
background-color: #3498db;
}
.webnots-information:before {
content: "\f129";
margin-left: 4px;
}
.webnots-question {
background-color: #f1c40f;
}
.webnots-question:before {
content: "\f128";
margin-left: 2px;
}
.webnots-tip {
background-color: #16a085;
}
.webnots-tip:before {
content: "\f0eb";
margin-left: 2px;
}
.webnots-notice {
background-color: #bea474;
}
.webnots-notice:before {
content: "\f0a1";
margin-left: -1px;
}
</style>

<div class="webnots-success webnots-notification-box">ì†Œì…œ ë¡œê·¸ì¸ ì²˜ë¦¬ ì‹œì— ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì •ë³´ë¥¼ ì¶”ì¶œí•œë‹¤.</div>
<div class="webnots-success webnots-notification-box">í˜„ì¬ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™í•´ì„œ ì‚¬ìš©ì ì •ë³´ë¥¼ ê´€ë¦¬í•´ì•¼ í•œë‹¤.</div>
<div class="webnots-success webnots-notification-box">ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œë„ ë¡œê·¸ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•˜ê³ , ì†Œì…œ ë¡œê·¸ì¸ìœ¼ë¡œë„ ë™ì¼í•˜ê²Œ ë™ì‘í•´ì•¼ í•œë‹¤. </div>

<p><br /></p>

<p>ê°€ì¥ ë¨¼ì € í•´ì•¼ í•˜ëŠ” ì‘ì—…ì€ êµ¬ê¸€ê³¼ ê°™ì€ ì„œë¹„ìŠ¤ì—ì„œ ë¡œê·¸ì¸ ì²˜ë¦¬ê°€ ëë‚œ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì‘ì—…ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ êµ¬ì„±í•˜ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ ìœ„í•´ì„œëŠ” ì‹¤ì œ ì†Œì…œ ë¡œê·¸ì¸ ê³¼ì •ì—ì„œ ë™ì‘í•˜ëŠ” ì¡´ì¬ì¸ <span style="color:orange; font-weight:bold">OAuth2UserService</span>ë¼ëŠ” ê²ƒì„ ì•Œì•„ì•¼ë§Œ í•œë‹¤.</p>

<p><br /></p>

<p><strong>org.springframework.security.oauth2.client.userinfo.OAuth2UserService ì¸í„°í˜ì´ìŠ¤</strong>ëŠ” <strong>UserDetailsService</strong>ì˜ <strong>OAuth</strong> ë²„ì „ì´ë¼ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì€ <strong>OAuthì˜ ì¸ì¦ ê²°ê³¼</strong>ë¥¼ ì²˜ë¦¬í•œë‹¤ëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<p>ì¸í„°í˜ì´ìŠ¤ë¥¼ ì§ì ‘ êµ¬í˜„í•  ìˆ˜ë„ ìˆì§€ë§Œ í¸í•˜ê²Œ í•˜ê³  ì‹¶ë‹¤ë©´ êµ¬í˜„ëœ í´ë˜ìŠ¤ ì¤‘ì—ì„œ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ ë” í¸í•  ê²ƒì´ë¯€ë¡œ <strong>DefaultOAuth2UserService</strong> í´ë˜ìŠ¤ë¥¼ ìƒì†í•´ì„œ êµ¬í˜„í•œë‹¤. security íŒ¨í‚¤ì§€ ë‚´ì— ìˆëŠ” service íŒ¨í‚¤ì§€ì— <strong>DefaultOAuth2UserService</strong>ë¥¼ ìƒì†í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ **ClubOAuth2UserDetailsServicesë¼ëŠ” í´ë˜ìŠ¤ë¡œ êµ¬ì„±í•œë‹¤.</p>

<p><br /></p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-11.2/2021-08-02-16-54-43.png" alt="" /></p>

<p><br /></p>

<p><strong>ClubOAuth2UserDetailsServices.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.young.club.security.service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.extern.log4j.Log4j2</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.client.userinfo.DefaultOAuth2UserService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.client.userinfo.OAuth2UserRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.core.OAuth2AuthenticationException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.core.user.OAuth2User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="nd">@Log4j2</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClubOAuth2UserDetailsService</span> <span class="kd">extends</span> <span class="nc">DefaultOAuth2UserService</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">OAuth2User</span> <span class="nf">loadUser</span><span class="o">(</span><span class="nc">OAuth2UserRequest</span> <span class="n">userRequest</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OAuth2AuthenticationException</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"---------------------------------------"</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"userRequest:"</span> <span class="o">+</span><span class="n">userRequest</span><span class="o">);</span>
        <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">loadUser</span><span class="o">(</span><span class="n">userRequest</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p><br /></p>

<p>í”„ë¡œì íŠ¸ë¥¼ ì¬ì‹œì‘í•œ í›„ì— â€˜/sample/memberâ€™ë¡œ ë¡œê·¸ì¸ì„ ì‹œë„í•˜ë©´ ìœ„ì˜ ì½”ë“œê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><img src="/images/SpringBoot/LearningSpringbootWithWebProject-11.2/2021-08-02-17-00-56.png" alt="" /></p>

<p><br /></p>

<p><span style="color:#85144b; font-weight:bold; font-size:30px">ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì¶”ì¶œ</span></p>

<p>loadUser()ì—ì„œ ì‚¬ìš©í•˜ëŠ” OAuth2UserRequestëŠ” í˜„ì¬ ì–´ë–¤ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ì„œ ë¡œê·¸ì¸ì´ ì´ë£¨ì–´ì¡ŒëŠ”ì§€ ì•Œì•„ë‚´ê³  ì „ë‹¬ëœ ê°’ë“¤ì„ ì¶”ì¶œí•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ Map&lt;String, Object&gt;ì˜ í˜•íƒœë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ìµœëŒ€í•œ ë§ì€ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•´ì„œ ClubOAuth2UserDetailsServiceì˜ loadUser()ë¥¼ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•œë‹¤.</p>

:ET